{"ast":null,"code":"module.exports = Tokenizer;\nvar decodeCodePoint = require(\"entities/lib/decode_codepoint.js\"),\n  entityMap = require(\"entities/maps/entities.json\"),\n  legacyMap = require(\"entities/maps/legacy.json\"),\n  xmlMap = require(\"entities/maps/xml.json\"),\n  i = 0,\n  TEXT = i++,\n  BEFORE_TAG_NAME = i++,\n  //after <\n  IN_TAG_NAME = i++,\n  IN_SELF_CLOSING_TAG = i++,\n  BEFORE_CLOSING_TAG_NAME = i++,\n  IN_CLOSING_TAG_NAME = i++,\n  AFTER_CLOSING_TAG_NAME = i++,\n  //attributes\n  BEFORE_ATTRIBUTE_NAME = i++,\n  IN_ATTRIBUTE_NAME = i++,\n  AFTER_ATTRIBUTE_NAME = i++,\n  BEFORE_ATTRIBUTE_VALUE = i++,\n  IN_ATTRIBUTE_VALUE_DQ = i++,\n  // \"\n  IN_ATTRIBUTE_VALUE_SQ = i++,\n  // '\n  IN_ATTRIBUTE_VALUE_NQ = i++,\n  //declarations\n  BEFORE_DECLARATION = i++,\n  // !\n  IN_DECLARATION = i++,\n  //processing instructions\n  IN_PROCESSING_INSTRUCTION = i++,\n  // ?\n\n  //comments\n  BEFORE_COMMENT = i++,\n  IN_COMMENT = i++,\n  AFTER_COMMENT_1 = i++,\n  AFTER_COMMENT_2 = i++,\n  //cdata\n  BEFORE_CDATA_1 = i++,\n  // [\n  BEFORE_CDATA_2 = i++,\n  // C\n  BEFORE_CDATA_3 = i++,\n  // D\n  BEFORE_CDATA_4 = i++,\n  // A\n  BEFORE_CDATA_5 = i++,\n  // T\n  BEFORE_CDATA_6 = i++,\n  // A\n  IN_CDATA = i++,\n  // [\n  AFTER_CDATA_1 = i++,\n  // ]\n  AFTER_CDATA_2 = i++,\n  // ]\n\n  //special tags\n  BEFORE_SPECIAL = i++,\n  //S\n  BEFORE_SPECIAL_END = i++,\n  //S\n\n  BEFORE_SCRIPT_1 = i++,\n  //C\n  BEFORE_SCRIPT_2 = i++,\n  //R\n  BEFORE_SCRIPT_3 = i++,\n  //I\n  BEFORE_SCRIPT_4 = i++,\n  //P\n  BEFORE_SCRIPT_5 = i++,\n  //T\n  AFTER_SCRIPT_1 = i++,\n  //C\n  AFTER_SCRIPT_2 = i++,\n  //R\n  AFTER_SCRIPT_3 = i++,\n  //I\n  AFTER_SCRIPT_4 = i++,\n  //P\n  AFTER_SCRIPT_5 = i++,\n  //T\n\n  BEFORE_STYLE_1 = i++,\n  //T\n  BEFORE_STYLE_2 = i++,\n  //Y\n  BEFORE_STYLE_3 = i++,\n  //L\n  BEFORE_STYLE_4 = i++,\n  //E\n  AFTER_STYLE_1 = i++,\n  //T\n  AFTER_STYLE_2 = i++,\n  //Y\n  AFTER_STYLE_3 = i++,\n  //L\n  AFTER_STYLE_4 = i++,\n  //E\n\n  BEFORE_ENTITY = i++,\n  //&\n  BEFORE_NUMERIC_ENTITY = i++,\n  //#\n  IN_NAMED_ENTITY = i++,\n  IN_NUMERIC_ENTITY = i++,\n  IN_HEX_ENTITY = i++,\n  //X\n\n  j = 0,\n  SPECIAL_NONE = j++,\n  SPECIAL_SCRIPT = j++,\n  SPECIAL_STYLE = j++;\nfunction whitespace(c) {\n  return c === \" \" || c === \"\\n\" || c === \"\\t\" || c === \"\\f\" || c === \"\\r\";\n}\nfunction characterState(char, SUCCESS) {\n  return function (c) {\n    if (c === char) this._state = SUCCESS;\n  };\n}\nfunction ifElseState(upper, SUCCESS, FAILURE) {\n  var lower = upper.toLowerCase();\n  if (upper === lower) {\n    return function (c) {\n      if (c === lower) {\n        this._state = SUCCESS;\n      } else {\n        this._state = FAILURE;\n        this._index--;\n      }\n    };\n  } else {\n    return function (c) {\n      if (c === lower || c === upper) {\n        this._state = SUCCESS;\n      } else {\n        this._state = FAILURE;\n        this._index--;\n      }\n    };\n  }\n}\nfunction consumeSpecialNameChar(upper, NEXT_STATE) {\n  var lower = upper.toLowerCase();\n  return function (c) {\n    if (c === lower || c === upper) {\n      this._state = NEXT_STATE;\n    } else {\n      this._state = IN_TAG_NAME;\n      this._index--; //consume the token again\n    }\n  };\n}\n\nfunction Tokenizer(options, cbs) {\n  this._state = TEXT;\n  this._buffer = \"\";\n  this._sectionStart = 0;\n  this._index = 0;\n  this._bufferOffset = 0; //chars removed from _buffer\n  this._baseState = TEXT;\n  this._special = SPECIAL_NONE;\n  this._cbs = cbs;\n  this._running = true;\n  this._ended = false;\n  this._xmlMode = !!(options && options.xmlMode);\n  this._decodeEntities = !!(options && options.decodeEntities);\n}\nTokenizer.prototype._stateText = function (c) {\n  if (c === \"<\") {\n    if (this._index > this._sectionStart) {\n      this._cbs.ontext(this._getSection());\n    }\n    this._state = BEFORE_TAG_NAME;\n    this._sectionStart = this._index;\n  } else if (this._decodeEntities && this._special === SPECIAL_NONE && c === \"&\") {\n    if (this._index > this._sectionStart) {\n      this._cbs.ontext(this._getSection());\n    }\n    this._baseState = TEXT;\n    this._state = BEFORE_ENTITY;\n    this._sectionStart = this._index;\n  }\n};\nTokenizer.prototype._stateBeforeTagName = function (c) {\n  if (c === \"/\") {\n    this._state = BEFORE_CLOSING_TAG_NAME;\n  } else if (c === \">\" || this._special !== SPECIAL_NONE || whitespace(c)) {\n    this._state = TEXT;\n  } else if (c === \"!\") {\n    this._state = BEFORE_DECLARATION;\n    this._sectionStart = this._index + 1;\n  } else if (c === \"?\") {\n    this._state = IN_PROCESSING_INSTRUCTION;\n    this._sectionStart = this._index + 1;\n  } else if (c === \"<\") {\n    this._cbs.ontext(this._getSection());\n    this._sectionStart = this._index;\n  } else {\n    this._state = !this._xmlMode && (c === \"s\" || c === \"S\") ? BEFORE_SPECIAL : IN_TAG_NAME;\n    this._sectionStart = this._index;\n  }\n};\nTokenizer.prototype._stateInTagName = function (c) {\n  if (c === \"/\" || c === \">\" || whitespace(c)) {\n    this._emitToken(\"onopentagname\");\n    this._state = BEFORE_ATTRIBUTE_NAME;\n    this._index--;\n  }\n};\nTokenizer.prototype._stateBeforeCloseingTagName = function (c) {\n  if (whitespace(c)) ;else if (c === \">\") {\n    this._state = TEXT;\n  } else if (this._special !== SPECIAL_NONE) {\n    if (c === \"s\" || c === \"S\") {\n      this._state = BEFORE_SPECIAL_END;\n    } else {\n      this._state = TEXT;\n      this._index--;\n    }\n  } else {\n    this._state = IN_CLOSING_TAG_NAME;\n    this._sectionStart = this._index;\n  }\n};\nTokenizer.prototype._stateInCloseingTagName = function (c) {\n  if (c === \">\" || whitespace(c)) {\n    this._emitToken(\"onclosetag\");\n    this._state = AFTER_CLOSING_TAG_NAME;\n    this._index--;\n  }\n};\nTokenizer.prototype._stateAfterCloseingTagName = function (c) {\n  //skip everything until \">\"\n  if (c === \">\") {\n    this._state = TEXT;\n    this._sectionStart = this._index + 1;\n  }\n};\nTokenizer.prototype._stateBeforeAttributeName = function (c) {\n  if (c === \">\") {\n    this._cbs.onopentagend();\n    this._state = TEXT;\n    this._sectionStart = this._index + 1;\n  } else if (c === \"/\") {\n    this._state = IN_SELF_CLOSING_TAG;\n  } else if (!whitespace(c)) {\n    this._state = IN_ATTRIBUTE_NAME;\n    this._sectionStart = this._index;\n  }\n};\nTokenizer.prototype._stateInSelfClosingTag = function (c) {\n  if (c === \">\") {\n    this._cbs.onselfclosingtag();\n    this._state = TEXT;\n    this._sectionStart = this._index + 1;\n  } else if (!whitespace(c)) {\n    this._state = BEFORE_ATTRIBUTE_NAME;\n    this._index--;\n  }\n};\nTokenizer.prototype._stateInAttributeName = function (c) {\n  if (c === \"=\" || c === \"/\" || c === \">\" || whitespace(c)) {\n    this._cbs.onattribname(this._getSection());\n    this._sectionStart = -1;\n    this._state = AFTER_ATTRIBUTE_NAME;\n    this._index--;\n  }\n};\nTokenizer.prototype._stateAfterAttributeName = function (c) {\n  if (c === \"=\") {\n    this._state = BEFORE_ATTRIBUTE_VALUE;\n  } else if (c === \"/\" || c === \">\") {\n    this._cbs.onattribend();\n    this._state = BEFORE_ATTRIBUTE_NAME;\n    this._index--;\n  } else if (!whitespace(c)) {\n    this._cbs.onattribend();\n    this._state = IN_ATTRIBUTE_NAME;\n    this._sectionStart = this._index;\n  }\n};\nTokenizer.prototype._stateBeforeAttributeValue = function (c) {\n  if (c === \"\\\"\") {\n    this._state = IN_ATTRIBUTE_VALUE_DQ;\n    this._sectionStart = this._index + 1;\n  } else if (c === \"'\") {\n    this._state = IN_ATTRIBUTE_VALUE_SQ;\n    this._sectionStart = this._index + 1;\n  } else if (!whitespace(c)) {\n    this._state = IN_ATTRIBUTE_VALUE_NQ;\n    this._sectionStart = this._index;\n    this._index--; //reconsume token\n  }\n};\n\nTokenizer.prototype._stateInAttributeValueDoubleQuotes = function (c) {\n  if (c === \"\\\"\") {\n    this._emitToken(\"onattribdata\");\n    this._cbs.onattribend();\n    this._state = BEFORE_ATTRIBUTE_NAME;\n  } else if (this._decodeEntities && c === \"&\") {\n    this._emitToken(\"onattribdata\");\n    this._baseState = this._state;\n    this._state = BEFORE_ENTITY;\n    this._sectionStart = this._index;\n  }\n};\nTokenizer.prototype._stateInAttributeValueSingleQuotes = function (c) {\n  if (c === \"'\") {\n    this._emitToken(\"onattribdata\");\n    this._cbs.onattribend();\n    this._state = BEFORE_ATTRIBUTE_NAME;\n  } else if (this._decodeEntities && c === \"&\") {\n    this._emitToken(\"onattribdata\");\n    this._baseState = this._state;\n    this._state = BEFORE_ENTITY;\n    this._sectionStart = this._index;\n  }\n};\nTokenizer.prototype._stateInAttributeValueNoQuotes = function (c) {\n  if (whitespace(c) || c === \">\") {\n    this._emitToken(\"onattribdata\");\n    this._cbs.onattribend();\n    this._state = BEFORE_ATTRIBUTE_NAME;\n    this._index--;\n  } else if (this._decodeEntities && c === \"&\") {\n    this._emitToken(\"onattribdata\");\n    this._baseState = this._state;\n    this._state = BEFORE_ENTITY;\n    this._sectionStart = this._index;\n  }\n};\nTokenizer.prototype._stateBeforeDeclaration = function (c) {\n  this._state = c === \"[\" ? BEFORE_CDATA_1 : c === \"-\" ? BEFORE_COMMENT : IN_DECLARATION;\n};\nTokenizer.prototype._stateInDeclaration = function (c) {\n  if (c === \">\") {\n    this._cbs.ondeclaration(this._getSection());\n    this._state = TEXT;\n    this._sectionStart = this._index + 1;\n  }\n};\nTokenizer.prototype._stateInProcessingInstruction = function (c) {\n  if (c === \">\") {\n    this._cbs.onprocessinginstruction(this._getSection());\n    this._state = TEXT;\n    this._sectionStart = this._index + 1;\n  }\n};\nTokenizer.prototype._stateBeforeComment = function (c) {\n  if (c === \"-\") {\n    this._state = IN_COMMENT;\n    this._sectionStart = this._index + 1;\n  } else {\n    this._state = IN_DECLARATION;\n  }\n};\nTokenizer.prototype._stateInComment = function (c) {\n  if (c === \"-\") this._state = AFTER_COMMENT_1;\n};\nTokenizer.prototype._stateAfterComment1 = function (c) {\n  if (c === \"-\") {\n    this._state = AFTER_COMMENT_2;\n  } else {\n    this._state = IN_COMMENT;\n  }\n};\nTokenizer.prototype._stateAfterComment2 = function (c) {\n  if (c === \">\") {\n    //remove 2 trailing chars\n    this._cbs.oncomment(this._buffer.substring(this._sectionStart, this._index - 2));\n    this._state = TEXT;\n    this._sectionStart = this._index + 1;\n  } else if (c !== \"-\") {\n    this._state = IN_COMMENT;\n  }\n  // else: stay in AFTER_COMMENT_2 (`--->`)\n};\n\nTokenizer.prototype._stateBeforeCdata1 = ifElseState(\"C\", BEFORE_CDATA_2, IN_DECLARATION);\nTokenizer.prototype._stateBeforeCdata2 = ifElseState(\"D\", BEFORE_CDATA_3, IN_DECLARATION);\nTokenizer.prototype._stateBeforeCdata3 = ifElseState(\"A\", BEFORE_CDATA_4, IN_DECLARATION);\nTokenizer.prototype._stateBeforeCdata4 = ifElseState(\"T\", BEFORE_CDATA_5, IN_DECLARATION);\nTokenizer.prototype._stateBeforeCdata5 = ifElseState(\"A\", BEFORE_CDATA_6, IN_DECLARATION);\nTokenizer.prototype._stateBeforeCdata6 = function (c) {\n  if (c === \"[\") {\n    this._state = IN_CDATA;\n    this._sectionStart = this._index + 1;\n  } else {\n    this._state = IN_DECLARATION;\n    this._index--;\n  }\n};\nTokenizer.prototype._stateInCdata = function (c) {\n  if (c === \"]\") this._state = AFTER_CDATA_1;\n};\nTokenizer.prototype._stateAfterCdata1 = characterState(\"]\", AFTER_CDATA_2);\nTokenizer.prototype._stateAfterCdata2 = function (c) {\n  if (c === \">\") {\n    //remove 2 trailing chars\n    this._cbs.oncdata(this._buffer.substring(this._sectionStart, this._index - 2));\n    this._state = TEXT;\n    this._sectionStart = this._index + 1;\n  } else if (c !== \"]\") {\n    this._state = IN_CDATA;\n  }\n  //else: stay in AFTER_CDATA_2 (`]]]>`)\n};\n\nTokenizer.prototype._stateBeforeSpecial = function (c) {\n  if (c === \"c\" || c === \"C\") {\n    this._state = BEFORE_SCRIPT_1;\n  } else if (c === \"t\" || c === \"T\") {\n    this._state = BEFORE_STYLE_1;\n  } else {\n    this._state = IN_TAG_NAME;\n    this._index--; //consume the token again\n  }\n};\n\nTokenizer.prototype._stateBeforeSpecialEnd = function (c) {\n  if (this._special === SPECIAL_SCRIPT && (c === \"c\" || c === \"C\")) {\n    this._state = AFTER_SCRIPT_1;\n  } else if (this._special === SPECIAL_STYLE && (c === \"t\" || c === \"T\")) {\n    this._state = AFTER_STYLE_1;\n  } else this._state = TEXT;\n};\nTokenizer.prototype._stateBeforeScript1 = consumeSpecialNameChar(\"R\", BEFORE_SCRIPT_2);\nTokenizer.prototype._stateBeforeScript2 = consumeSpecialNameChar(\"I\", BEFORE_SCRIPT_3);\nTokenizer.prototype._stateBeforeScript3 = consumeSpecialNameChar(\"P\", BEFORE_SCRIPT_4);\nTokenizer.prototype._stateBeforeScript4 = consumeSpecialNameChar(\"T\", BEFORE_SCRIPT_5);\nTokenizer.prototype._stateBeforeScript5 = function (c) {\n  if (c === \"/\" || c === \">\" || whitespace(c)) {\n    this._special = SPECIAL_SCRIPT;\n  }\n  this._state = IN_TAG_NAME;\n  this._index--; //consume the token again\n};\n\nTokenizer.prototype._stateAfterScript1 = ifElseState(\"R\", AFTER_SCRIPT_2, TEXT);\nTokenizer.prototype._stateAfterScript2 = ifElseState(\"I\", AFTER_SCRIPT_3, TEXT);\nTokenizer.prototype._stateAfterScript3 = ifElseState(\"P\", AFTER_SCRIPT_4, TEXT);\nTokenizer.prototype._stateAfterScript4 = ifElseState(\"T\", AFTER_SCRIPT_5, TEXT);\nTokenizer.prototype._stateAfterScript5 = function (c) {\n  if (c === \">\" || whitespace(c)) {\n    this._special = SPECIAL_NONE;\n    this._state = IN_CLOSING_TAG_NAME;\n    this._sectionStart = this._index - 6;\n    this._index--; //reconsume the token\n  } else this._state = TEXT;\n};\nTokenizer.prototype._stateBeforeStyle1 = consumeSpecialNameChar(\"Y\", BEFORE_STYLE_2);\nTokenizer.prototype._stateBeforeStyle2 = consumeSpecialNameChar(\"L\", BEFORE_STYLE_3);\nTokenizer.prototype._stateBeforeStyle3 = consumeSpecialNameChar(\"E\", BEFORE_STYLE_4);\nTokenizer.prototype._stateBeforeStyle4 = function (c) {\n  if (c === \"/\" || c === \">\" || whitespace(c)) {\n    this._special = SPECIAL_STYLE;\n  }\n  this._state = IN_TAG_NAME;\n  this._index--; //consume the token again\n};\n\nTokenizer.prototype._stateAfterStyle1 = ifElseState(\"Y\", AFTER_STYLE_2, TEXT);\nTokenizer.prototype._stateAfterStyle2 = ifElseState(\"L\", AFTER_STYLE_3, TEXT);\nTokenizer.prototype._stateAfterStyle3 = ifElseState(\"E\", AFTER_STYLE_4, TEXT);\nTokenizer.prototype._stateAfterStyle4 = function (c) {\n  if (c === \">\" || whitespace(c)) {\n    this._special = SPECIAL_NONE;\n    this._state = IN_CLOSING_TAG_NAME;\n    this._sectionStart = this._index - 5;\n    this._index--; //reconsume the token\n  } else this._state = TEXT;\n};\nTokenizer.prototype._stateBeforeEntity = ifElseState(\"#\", BEFORE_NUMERIC_ENTITY, IN_NAMED_ENTITY);\nTokenizer.prototype._stateBeforeNumericEntity = ifElseState(\"X\", IN_HEX_ENTITY, IN_NUMERIC_ENTITY);\n\n//for entities terminated with a semicolon\nTokenizer.prototype._parseNamedEntityStrict = function () {\n  //offset = 1\n  if (this._sectionStart + 1 < this._index) {\n    var entity = this._buffer.substring(this._sectionStart + 1, this._index),\n      map = this._xmlMode ? xmlMap : entityMap;\n    if (map.hasOwnProperty(entity)) {\n      this._emitPartial(map[entity]);\n      this._sectionStart = this._index + 1;\n    }\n  }\n};\n\n//parses legacy entities (without trailing semicolon)\nTokenizer.prototype._parseLegacyEntity = function () {\n  var start = this._sectionStart + 1,\n    limit = this._index - start;\n  if (limit > 6) limit = 6; //the max length of legacy entities is 6\n\n  while (limit >= 2) {\n    //the min length of legacy entities is 2\n    var entity = this._buffer.substr(start, limit);\n    if (legacyMap.hasOwnProperty(entity)) {\n      this._emitPartial(legacyMap[entity]);\n      this._sectionStart += limit + 1;\n      return;\n    } else {\n      limit--;\n    }\n  }\n};\nTokenizer.prototype._stateInNamedEntity = function (c) {\n  if (c === \";\") {\n    this._parseNamedEntityStrict();\n    if (this._sectionStart + 1 < this._index && !this._xmlMode) {\n      this._parseLegacyEntity();\n    }\n    this._state = this._baseState;\n  } else if ((c < \"a\" || c > \"z\") && (c < \"A\" || c > \"Z\") && (c < \"0\" || c > \"9\")) {\n    if (this._xmlMode) ;else if (this._sectionStart + 1 === this._index) ;else if (this._baseState !== TEXT) {\n      if (c !== \"=\") {\n        this._parseNamedEntityStrict();\n      }\n    } else {\n      this._parseLegacyEntity();\n    }\n    this._state = this._baseState;\n    this._index--;\n  }\n};\nTokenizer.prototype._decodeNumericEntity = function (offset, base) {\n  var sectionStart = this._sectionStart + offset;\n  if (sectionStart !== this._index) {\n    //parse entity\n    var entity = this._buffer.substring(sectionStart, this._index);\n    var parsed = parseInt(entity, base);\n    this._emitPartial(decodeCodePoint(parsed));\n    this._sectionStart = this._index;\n  } else {\n    this._sectionStart--;\n  }\n  this._state = this._baseState;\n};\nTokenizer.prototype._stateInNumericEntity = function (c) {\n  if (c === \";\") {\n    this._decodeNumericEntity(2, 10);\n    this._sectionStart++;\n  } else if (c < \"0\" || c > \"9\") {\n    if (!this._xmlMode) {\n      this._decodeNumericEntity(2, 10);\n    } else {\n      this._state = this._baseState;\n    }\n    this._index--;\n  }\n};\nTokenizer.prototype._stateInHexEntity = function (c) {\n  if (c === \";\") {\n    this._decodeNumericEntity(3, 16);\n    this._sectionStart++;\n  } else if ((c < \"a\" || c > \"f\") && (c < \"A\" || c > \"F\") && (c < \"0\" || c > \"9\")) {\n    if (!this._xmlMode) {\n      this._decodeNumericEntity(3, 16);\n    } else {\n      this._state = this._baseState;\n    }\n    this._index--;\n  }\n};\nTokenizer.prototype._cleanup = function () {\n  if (this._sectionStart < 0) {\n    this._buffer = \"\";\n    this._index = 0;\n    this._bufferOffset += this._index;\n  } else if (this._running) {\n    if (this._state === TEXT) {\n      if (this._sectionStart !== this._index) {\n        this._cbs.ontext(this._buffer.substr(this._sectionStart));\n      }\n      this._buffer = \"\";\n      this._index = 0;\n      this._bufferOffset += this._index;\n    } else if (this._sectionStart === this._index) {\n      //the section just started\n      this._buffer = \"\";\n      this._index = 0;\n      this._bufferOffset += this._index;\n    } else {\n      //remove everything unnecessary\n      this._buffer = this._buffer.substr(this._sectionStart);\n      this._index -= this._sectionStart;\n      this._bufferOffset += this._sectionStart;\n    }\n    this._sectionStart = 0;\n  }\n};\n\n//TODO make events conditional\nTokenizer.prototype.write = function (chunk) {\n  if (this._ended) this._cbs.onerror(Error(\".write() after done!\"));\n  this._buffer += chunk;\n  this._parse();\n};\nTokenizer.prototype._parse = function () {\n  while (this._index < this._buffer.length && this._running) {\n    var c = this._buffer.charAt(this._index);\n    if (this._state === TEXT) {\n      this._stateText(c);\n    } else if (this._state === BEFORE_TAG_NAME) {\n      this._stateBeforeTagName(c);\n    } else if (this._state === IN_TAG_NAME) {\n      this._stateInTagName(c);\n    } else if (this._state === BEFORE_CLOSING_TAG_NAME) {\n      this._stateBeforeCloseingTagName(c);\n    } else if (this._state === IN_CLOSING_TAG_NAME) {\n      this._stateInCloseingTagName(c);\n    } else if (this._state === AFTER_CLOSING_TAG_NAME) {\n      this._stateAfterCloseingTagName(c);\n    } else if (this._state === IN_SELF_CLOSING_TAG) {\n      this._stateInSelfClosingTag(c);\n    }\n\n    /*\n    *\tattributes\n    */else if (this._state === BEFORE_ATTRIBUTE_NAME) {\n      this._stateBeforeAttributeName(c);\n    } else if (this._state === IN_ATTRIBUTE_NAME) {\n      this._stateInAttributeName(c);\n    } else if (this._state === AFTER_ATTRIBUTE_NAME) {\n      this._stateAfterAttributeName(c);\n    } else if (this._state === BEFORE_ATTRIBUTE_VALUE) {\n      this._stateBeforeAttributeValue(c);\n    } else if (this._state === IN_ATTRIBUTE_VALUE_DQ) {\n      this._stateInAttributeValueDoubleQuotes(c);\n    } else if (this._state === IN_ATTRIBUTE_VALUE_SQ) {\n      this._stateInAttributeValueSingleQuotes(c);\n    } else if (this._state === IN_ATTRIBUTE_VALUE_NQ) {\n      this._stateInAttributeValueNoQuotes(c);\n    }\n\n    /*\n    *\tdeclarations\n    */else if (this._state === BEFORE_DECLARATION) {\n      this._stateBeforeDeclaration(c);\n    } else if (this._state === IN_DECLARATION) {\n      this._stateInDeclaration(c);\n    }\n\n    /*\n    *\tprocessing instructions\n    */else if (this._state === IN_PROCESSING_INSTRUCTION) {\n      this._stateInProcessingInstruction(c);\n    }\n\n    /*\n    *\tcomments\n    */else if (this._state === BEFORE_COMMENT) {\n      this._stateBeforeComment(c);\n    } else if (this._state === IN_COMMENT) {\n      this._stateInComment(c);\n    } else if (this._state === AFTER_COMMENT_1) {\n      this._stateAfterComment1(c);\n    } else if (this._state === AFTER_COMMENT_2) {\n      this._stateAfterComment2(c);\n    }\n\n    /*\n    *\tcdata\n    */else if (this._state === BEFORE_CDATA_1) {\n      this._stateBeforeCdata1(c);\n    } else if (this._state === BEFORE_CDATA_2) {\n      this._stateBeforeCdata2(c);\n    } else if (this._state === BEFORE_CDATA_3) {\n      this._stateBeforeCdata3(c);\n    } else if (this._state === BEFORE_CDATA_4) {\n      this._stateBeforeCdata4(c);\n    } else if (this._state === BEFORE_CDATA_5) {\n      this._stateBeforeCdata5(c);\n    } else if (this._state === BEFORE_CDATA_6) {\n      this._stateBeforeCdata6(c);\n    } else if (this._state === IN_CDATA) {\n      this._stateInCdata(c);\n    } else if (this._state === AFTER_CDATA_1) {\n      this._stateAfterCdata1(c);\n    } else if (this._state === AFTER_CDATA_2) {\n      this._stateAfterCdata2(c);\n    }\n\n    /*\n    * special tags\n    */else if (this._state === BEFORE_SPECIAL) {\n      this._stateBeforeSpecial(c);\n    } else if (this._state === BEFORE_SPECIAL_END) {\n      this._stateBeforeSpecialEnd(c);\n    }\n\n    /*\n    * script\n    */else if (this._state === BEFORE_SCRIPT_1) {\n      this._stateBeforeScript1(c);\n    } else if (this._state === BEFORE_SCRIPT_2) {\n      this._stateBeforeScript2(c);\n    } else if (this._state === BEFORE_SCRIPT_3) {\n      this._stateBeforeScript3(c);\n    } else if (this._state === BEFORE_SCRIPT_4) {\n      this._stateBeforeScript4(c);\n    } else if (this._state === BEFORE_SCRIPT_5) {\n      this._stateBeforeScript5(c);\n    } else if (this._state === AFTER_SCRIPT_1) {\n      this._stateAfterScript1(c);\n    } else if (this._state === AFTER_SCRIPT_2) {\n      this._stateAfterScript2(c);\n    } else if (this._state === AFTER_SCRIPT_3) {\n      this._stateAfterScript3(c);\n    } else if (this._state === AFTER_SCRIPT_4) {\n      this._stateAfterScript4(c);\n    } else if (this._state === AFTER_SCRIPT_5) {\n      this._stateAfterScript5(c);\n    }\n\n    /*\n    * style\n    */else if (this._state === BEFORE_STYLE_1) {\n      this._stateBeforeStyle1(c);\n    } else if (this._state === BEFORE_STYLE_2) {\n      this._stateBeforeStyle2(c);\n    } else if (this._state === BEFORE_STYLE_3) {\n      this._stateBeforeStyle3(c);\n    } else if (this._state === BEFORE_STYLE_4) {\n      this._stateBeforeStyle4(c);\n    } else if (this._state === AFTER_STYLE_1) {\n      this._stateAfterStyle1(c);\n    } else if (this._state === AFTER_STYLE_2) {\n      this._stateAfterStyle2(c);\n    } else if (this._state === AFTER_STYLE_3) {\n      this._stateAfterStyle3(c);\n    } else if (this._state === AFTER_STYLE_4) {\n      this._stateAfterStyle4(c);\n    }\n\n    /*\n    * entities\n    */else if (this._state === BEFORE_ENTITY) {\n      this._stateBeforeEntity(c);\n    } else if (this._state === BEFORE_NUMERIC_ENTITY) {\n      this._stateBeforeNumericEntity(c);\n    } else if (this._state === IN_NAMED_ENTITY) {\n      this._stateInNamedEntity(c);\n    } else if (this._state === IN_NUMERIC_ENTITY) {\n      this._stateInNumericEntity(c);\n    } else if (this._state === IN_HEX_ENTITY) {\n      this._stateInHexEntity(c);\n    } else {\n      this._cbs.onerror(Error(\"unknown _state\"), this._state);\n    }\n    this._index++;\n  }\n  this._cleanup();\n};\nTokenizer.prototype.pause = function () {\n  this._running = false;\n};\nTokenizer.prototype.resume = function () {\n  this._running = true;\n  if (this._index < this._buffer.length) {\n    this._parse();\n  }\n  if (this._ended) {\n    this._finish();\n  }\n};\nTokenizer.prototype.end = function (chunk) {\n  if (this._ended) this._cbs.onerror(Error(\".end() after done!\"));\n  if (chunk) this.write(chunk);\n  this._ended = true;\n  if (this._running) this._finish();\n};\nTokenizer.prototype._finish = function () {\n  //if there is remaining data, emit it in a reasonable way\n  if (this._sectionStart < this._index) {\n    this._handleTrailingData();\n  }\n  this._cbs.onend();\n};\nTokenizer.prototype._handleTrailingData = function () {\n  var data = this._buffer.substr(this._sectionStart);\n  if (this._state === IN_CDATA || this._state === AFTER_CDATA_1 || this._state === AFTER_CDATA_2) {\n    this._cbs.oncdata(data);\n  } else if (this._state === IN_COMMENT || this._state === AFTER_COMMENT_1 || this._state === AFTER_COMMENT_2) {\n    this._cbs.oncomment(data);\n  } else if (this._state === IN_NAMED_ENTITY && !this._xmlMode) {\n    this._parseLegacyEntity();\n    if (this._sectionStart < this._index) {\n      this._state = this._baseState;\n      this._handleTrailingData();\n    }\n  } else if (this._state === IN_NUMERIC_ENTITY && !this._xmlMode) {\n    this._decodeNumericEntity(2, 10);\n    if (this._sectionStart < this._index) {\n      this._state = this._baseState;\n      this._handleTrailingData();\n    }\n  } else if (this._state === IN_HEX_ENTITY && !this._xmlMode) {\n    this._decodeNumericEntity(3, 16);\n    if (this._sectionStart < this._index) {\n      this._state = this._baseState;\n      this._handleTrailingData();\n    }\n  } else if (this._state !== IN_TAG_NAME && this._state !== BEFORE_ATTRIBUTE_NAME && this._state !== BEFORE_ATTRIBUTE_VALUE && this._state !== AFTER_ATTRIBUTE_NAME && this._state !== IN_ATTRIBUTE_NAME && this._state !== IN_ATTRIBUTE_VALUE_SQ && this._state !== IN_ATTRIBUTE_VALUE_DQ && this._state !== IN_ATTRIBUTE_VALUE_NQ && this._state !== IN_CLOSING_TAG_NAME) {\n    this._cbs.ontext(data);\n  }\n  //else, ignore remaining data\n  //TODO add a way to remove current tag\n};\n\nTokenizer.prototype.reset = function () {\n  Tokenizer.call(this, {\n    xmlMode: this._xmlMode,\n    decodeEntities: this._decodeEntities\n  }, this._cbs);\n};\nTokenizer.prototype.getAbsoluteIndex = function () {\n  return this._bufferOffset + this._index;\n};\nTokenizer.prototype._getSection = function () {\n  return this._buffer.substring(this._sectionStart, this._index);\n};\nTokenizer.prototype._emitToken = function (name) {\n  this._cbs[name](this._getSection());\n  this._sectionStart = -1;\n};\nTokenizer.prototype._emitPartial = function (value) {\n  if (this._baseState !== TEXT) {\n    this._cbs.onattribdata(value); //TODO implement the new event\n  } else {\n    this._cbs.ontext(value);\n  }\n};","map":{"version":3,"names":["module","exports","Tokenizer","decodeCodePoint","require","entityMap","legacyMap","xmlMap","i","TEXT","BEFORE_TAG_NAME","IN_TAG_NAME","IN_SELF_CLOSING_TAG","BEFORE_CLOSING_TAG_NAME","IN_CLOSING_TAG_NAME","AFTER_CLOSING_TAG_NAME","BEFORE_ATTRIBUTE_NAME","IN_ATTRIBUTE_NAME","AFTER_ATTRIBUTE_NAME","BEFORE_ATTRIBUTE_VALUE","IN_ATTRIBUTE_VALUE_DQ","IN_ATTRIBUTE_VALUE_SQ","IN_ATTRIBUTE_VALUE_NQ","BEFORE_DECLARATION","IN_DECLARATION","IN_PROCESSING_INSTRUCTION","BEFORE_COMMENT","IN_COMMENT","AFTER_COMMENT_1","AFTER_COMMENT_2","BEFORE_CDATA_1","BEFORE_CDATA_2","BEFORE_CDATA_3","BEFORE_CDATA_4","BEFORE_CDATA_5","BEFORE_CDATA_6","IN_CDATA","AFTER_CDATA_1","AFTER_CDATA_2","BEFORE_SPECIAL","BEFORE_SPECIAL_END","BEFORE_SCRIPT_1","BEFORE_SCRIPT_2","BEFORE_SCRIPT_3","BEFORE_SCRIPT_4","BEFORE_SCRIPT_5","AFTER_SCRIPT_1","AFTER_SCRIPT_2","AFTER_SCRIPT_3","AFTER_SCRIPT_4","AFTER_SCRIPT_5","BEFORE_STYLE_1","BEFORE_STYLE_2","BEFORE_STYLE_3","BEFORE_STYLE_4","AFTER_STYLE_1","AFTER_STYLE_2","AFTER_STYLE_3","AFTER_STYLE_4","BEFORE_ENTITY","BEFORE_NUMERIC_ENTITY","IN_NAMED_ENTITY","IN_NUMERIC_ENTITY","IN_HEX_ENTITY","j","SPECIAL_NONE","SPECIAL_SCRIPT","SPECIAL_STYLE","whitespace","c","characterState","char","SUCCESS","_state","ifElseState","upper","FAILURE","lower","toLowerCase","_index","consumeSpecialNameChar","NEXT_STATE","options","cbs","_buffer","_sectionStart","_bufferOffset","_baseState","_special","_cbs","_running","_ended","_xmlMode","xmlMode","_decodeEntities","decodeEntities","prototype","_stateText","ontext","_getSection","_stateBeforeTagName","_stateInTagName","_emitToken","_stateBeforeCloseingTagName","_stateInCloseingTagName","_stateAfterCloseingTagName","_stateBeforeAttributeName","onopentagend","_stateInSelfClosingTag","onselfclosingtag","_stateInAttributeName","onattribname","_stateAfterAttributeName","onattribend","_stateBeforeAttributeValue","_stateInAttributeValueDoubleQuotes","_stateInAttributeValueSingleQuotes","_stateInAttributeValueNoQuotes","_stateBeforeDeclaration","_stateInDeclaration","ondeclaration","_stateInProcessingInstruction","onprocessinginstruction","_stateBeforeComment","_stateInComment","_stateAfterComment1","_stateAfterComment2","oncomment","substring","_stateBeforeCdata1","_stateBeforeCdata2","_stateBeforeCdata3","_stateBeforeCdata4","_stateBeforeCdata5","_stateBeforeCdata6","_stateInCdata","_stateAfterCdata1","_stateAfterCdata2","oncdata","_stateBeforeSpecial","_stateBeforeSpecialEnd","_stateBeforeScript1","_stateBeforeScript2","_stateBeforeScript3","_stateBeforeScript4","_stateBeforeScript5","_stateAfterScript1","_stateAfterScript2","_stateAfterScript3","_stateAfterScript4","_stateAfterScript5","_stateBeforeStyle1","_stateBeforeStyle2","_stateBeforeStyle3","_stateBeforeStyle4","_stateAfterStyle1","_stateAfterStyle2","_stateAfterStyle3","_stateAfterStyle4","_stateBeforeEntity","_stateBeforeNumericEntity","_parseNamedEntityStrict","entity","map","hasOwnProperty","_emitPartial","_parseLegacyEntity","start","limit","substr","_stateInNamedEntity","_decodeNumericEntity","offset","base","sectionStart","parsed","parseInt","_stateInNumericEntity","_stateInHexEntity","_cleanup","write","chunk","onerror","Error","_parse","length","charAt","pause","resume","_finish","end","_handleTrailingData","onend","data","reset","call","getAbsoluteIndex","name","value","onattribdata"],"sources":["C:/Users/Microsoft/OneDrive/Documents/c prgramming/.dist/react js/songProject/my-app/node_modules/cheerio/node_modules/htmlparser2/lib/Tokenizer.js"],"sourcesContent":["module.exports = Tokenizer;\n\nvar decodeCodePoint = require(\"entities/lib/decode_codepoint.js\"),\n    entityMap = require(\"entities/maps/entities.json\"),\n    legacyMap = require(\"entities/maps/legacy.json\"),\n    xmlMap    = require(\"entities/maps/xml.json\"),\n\n    i = 0,\n\n    TEXT                      = i++,\n    BEFORE_TAG_NAME           = i++, //after <\n    IN_TAG_NAME               = i++,\n    IN_SELF_CLOSING_TAG       = i++,\n    BEFORE_CLOSING_TAG_NAME   = i++,\n    IN_CLOSING_TAG_NAME       = i++,\n    AFTER_CLOSING_TAG_NAME    = i++,\n\n    //attributes\n    BEFORE_ATTRIBUTE_NAME     = i++,\n    IN_ATTRIBUTE_NAME         = i++,\n    AFTER_ATTRIBUTE_NAME      = i++,\n    BEFORE_ATTRIBUTE_VALUE    = i++,\n    IN_ATTRIBUTE_VALUE_DQ     = i++, // \"\n    IN_ATTRIBUTE_VALUE_SQ     = i++, // '\n    IN_ATTRIBUTE_VALUE_NQ     = i++,\n\n    //declarations\n    BEFORE_DECLARATION        = i++, // !\n    IN_DECLARATION            = i++,\n\n    //processing instructions\n    IN_PROCESSING_INSTRUCTION = i++, // ?\n\n    //comments\n    BEFORE_COMMENT            = i++,\n    IN_COMMENT                = i++,\n    AFTER_COMMENT_1           = i++,\n    AFTER_COMMENT_2           = i++,\n\n    //cdata\n    BEFORE_CDATA_1            = i++, // [\n    BEFORE_CDATA_2            = i++, // C\n    BEFORE_CDATA_3            = i++, // D\n    BEFORE_CDATA_4            = i++, // A\n    BEFORE_CDATA_5            = i++, // T\n    BEFORE_CDATA_6            = i++, // A\n    IN_CDATA                  = i++, // [\n    AFTER_CDATA_1             = i++, // ]\n    AFTER_CDATA_2             = i++, // ]\n\n    //special tags\n    BEFORE_SPECIAL            = i++, //S\n    BEFORE_SPECIAL_END        = i++,   //S\n\n    BEFORE_SCRIPT_1           = i++, //C\n    BEFORE_SCRIPT_2           = i++, //R\n    BEFORE_SCRIPT_3           = i++, //I\n    BEFORE_SCRIPT_4           = i++, //P\n    BEFORE_SCRIPT_5           = i++, //T\n    AFTER_SCRIPT_1            = i++, //C\n    AFTER_SCRIPT_2            = i++, //R\n    AFTER_SCRIPT_3            = i++, //I\n    AFTER_SCRIPT_4            = i++, //P\n    AFTER_SCRIPT_5            = i++, //T\n\n    BEFORE_STYLE_1            = i++, //T\n    BEFORE_STYLE_2            = i++, //Y\n    BEFORE_STYLE_3            = i++, //L\n    BEFORE_STYLE_4            = i++, //E\n    AFTER_STYLE_1             = i++, //T\n    AFTER_STYLE_2             = i++, //Y\n    AFTER_STYLE_3             = i++, //L\n    AFTER_STYLE_4             = i++, //E\n\n    BEFORE_ENTITY             = i++, //&\n    BEFORE_NUMERIC_ENTITY     = i++, //#\n    IN_NAMED_ENTITY           = i++,\n    IN_NUMERIC_ENTITY         = i++,\n    IN_HEX_ENTITY             = i++, //X\n\n    j = 0,\n\n    SPECIAL_NONE              = j++,\n    SPECIAL_SCRIPT            = j++,\n    SPECIAL_STYLE             = j++;\n\nfunction whitespace(c){\n\treturn c === \" \" || c === \"\\n\" || c === \"\\t\" || c === \"\\f\" || c === \"\\r\";\n}\n\nfunction characterState(char, SUCCESS){\n\treturn function(c){\n\t\tif(c === char) this._state = SUCCESS;\n\t};\n}\n\nfunction ifElseState(upper, SUCCESS, FAILURE){\n\tvar lower = upper.toLowerCase();\n\n\tif(upper === lower){\n\t\treturn function(c){\n\t\t\tif(c === lower){\n\t\t\t\tthis._state = SUCCESS;\n\t\t\t} else {\n\t\t\t\tthis._state = FAILURE;\n\t\t\t\tthis._index--;\n\t\t\t}\n\t\t};\n\t} else {\n\t\treturn function(c){\n\t\t\tif(c === lower || c === upper){\n\t\t\t\tthis._state = SUCCESS;\n\t\t\t} else {\n\t\t\t\tthis._state = FAILURE;\n\t\t\t\tthis._index--;\n\t\t\t}\n\t\t};\n\t}\n}\n\nfunction consumeSpecialNameChar(upper, NEXT_STATE){\n\tvar lower = upper.toLowerCase();\n\n\treturn function(c){\n\t\tif(c === lower || c === upper){\n\t\t\tthis._state = NEXT_STATE;\n\t\t} else {\n\t\t\tthis._state = IN_TAG_NAME;\n\t\t\tthis._index--; //consume the token again\n\t\t}\n\t};\n}\n\nfunction Tokenizer(options, cbs){\n\tthis._state = TEXT;\n\tthis._buffer = \"\";\n\tthis._sectionStart = 0;\n\tthis._index = 0;\n\tthis._bufferOffset = 0; //chars removed from _buffer\n\tthis._baseState = TEXT;\n\tthis._special = SPECIAL_NONE;\n\tthis._cbs = cbs;\n\tthis._running = true;\n\tthis._ended = false;\n\tthis._xmlMode = !!(options && options.xmlMode);\n\tthis._decodeEntities = !!(options && options.decodeEntities);\n}\n\nTokenizer.prototype._stateText = function(c){\n\tif(c === \"<\"){\n\t\tif(this._index > this._sectionStart){\n\t\t\tthis._cbs.ontext(this._getSection());\n\t\t}\n\t\tthis._state = BEFORE_TAG_NAME;\n\t\tthis._sectionStart = this._index;\n\t} else if(this._decodeEntities && this._special === SPECIAL_NONE && c === \"&\"){\n\t\tif(this._index > this._sectionStart){\n\t\t\tthis._cbs.ontext(this._getSection());\n\t\t}\n\t\tthis._baseState = TEXT;\n\t\tthis._state = BEFORE_ENTITY;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateBeforeTagName = function(c){\n\tif(c === \"/\"){\n\t\tthis._state = BEFORE_CLOSING_TAG_NAME;\n\t} else if(c === \">\" || this._special !== SPECIAL_NONE || whitespace(c)) {\n\t\tthis._state = TEXT;\n\t} else if(c === \"!\"){\n\t\tthis._state = BEFORE_DECLARATION;\n\t\tthis._sectionStart = this._index + 1;\n\t} else if(c === \"?\"){\n\t\tthis._state = IN_PROCESSING_INSTRUCTION;\n\t\tthis._sectionStart = this._index + 1;\n\t} else if(c === \"<\"){\n\t\tthis._cbs.ontext(this._getSection());\n\t\tthis._sectionStart = this._index;\n\t} else {\n\t\tthis._state = (!this._xmlMode && (c === \"s\" || c === \"S\")) ?\n\t\t\t\t\t\tBEFORE_SPECIAL : IN_TAG_NAME;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateInTagName = function(c){\n\tif(c === \"/\" || c === \">\" || whitespace(c)){\n\t\tthis._emitToken(\"onopentagname\");\n\t\tthis._state = BEFORE_ATTRIBUTE_NAME;\n\t\tthis._index--;\n\t}\n};\n\nTokenizer.prototype._stateBeforeCloseingTagName = function(c){\n\tif(whitespace(c));\n\telse if(c === \">\"){\n\t\tthis._state = TEXT;\n\t} else if(this._special !== SPECIAL_NONE){\n\t\tif(c === \"s\" || c === \"S\"){\n\t\t\tthis._state = BEFORE_SPECIAL_END;\n\t\t} else {\n\t\t\tthis._state = TEXT;\n\t\t\tthis._index--;\n\t\t}\n\t} else {\n\t\tthis._state = IN_CLOSING_TAG_NAME;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateInCloseingTagName = function(c){\n\tif(c === \">\" || whitespace(c)){\n\t\tthis._emitToken(\"onclosetag\");\n\t\tthis._state = AFTER_CLOSING_TAG_NAME;\n\t\tthis._index--;\n\t}\n};\n\nTokenizer.prototype._stateAfterCloseingTagName = function(c){\n\t//skip everything until \">\"\n\tif(c === \">\"){\n\t\tthis._state = TEXT;\n\t\tthis._sectionStart = this._index + 1;\n\t}\n};\n\nTokenizer.prototype._stateBeforeAttributeName = function(c){\n\tif(c === \">\"){\n\t\tthis._cbs.onopentagend();\n\t\tthis._state = TEXT;\n\t\tthis._sectionStart = this._index + 1;\n\t} else if(c === \"/\"){\n\t\tthis._state = IN_SELF_CLOSING_TAG;\n\t} else if(!whitespace(c)){\n\t\tthis._state = IN_ATTRIBUTE_NAME;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateInSelfClosingTag = function(c){\n\tif(c === \">\"){\n\t\tthis._cbs.onselfclosingtag();\n\t\tthis._state = TEXT;\n\t\tthis._sectionStart = this._index + 1;\n\t} else if(!whitespace(c)){\n\t\tthis._state = BEFORE_ATTRIBUTE_NAME;\n\t\tthis._index--;\n\t}\n};\n\nTokenizer.prototype._stateInAttributeName = function(c){\n\tif(c === \"=\" || c === \"/\" || c === \">\" || whitespace(c)){\n\t\tthis._cbs.onattribname(this._getSection());\n\t\tthis._sectionStart = -1;\n\t\tthis._state = AFTER_ATTRIBUTE_NAME;\n\t\tthis._index--;\n\t}\n};\n\nTokenizer.prototype._stateAfterAttributeName = function(c){\n\tif(c === \"=\"){\n\t\tthis._state = BEFORE_ATTRIBUTE_VALUE;\n\t} else if(c === \"/\" || c === \">\"){\n\t\tthis._cbs.onattribend();\n\t\tthis._state = BEFORE_ATTRIBUTE_NAME;\n\t\tthis._index--;\n\t} else if(!whitespace(c)){\n\t\tthis._cbs.onattribend();\n\t\tthis._state = IN_ATTRIBUTE_NAME;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateBeforeAttributeValue = function(c){\n\tif(c === \"\\\"\"){\n\t\tthis._state = IN_ATTRIBUTE_VALUE_DQ;\n\t\tthis._sectionStart = this._index + 1;\n\t} else if(c === \"'\"){\n\t\tthis._state = IN_ATTRIBUTE_VALUE_SQ;\n\t\tthis._sectionStart = this._index + 1;\n\t} else if(!whitespace(c)){\n\t\tthis._state = IN_ATTRIBUTE_VALUE_NQ;\n\t\tthis._sectionStart = this._index;\n\t\tthis._index--; //reconsume token\n\t}\n};\n\nTokenizer.prototype._stateInAttributeValueDoubleQuotes = function(c){\n\tif(c === \"\\\"\"){\n\t\tthis._emitToken(\"onattribdata\");\n\t\tthis._cbs.onattribend();\n\t\tthis._state = BEFORE_ATTRIBUTE_NAME;\n\t} else if(this._decodeEntities && c === \"&\"){\n\t\tthis._emitToken(\"onattribdata\");\n\t\tthis._baseState = this._state;\n\t\tthis._state = BEFORE_ENTITY;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateInAttributeValueSingleQuotes = function(c){\n\tif(c === \"'\"){\n\t\tthis._emitToken(\"onattribdata\");\n\t\tthis._cbs.onattribend();\n\t\tthis._state = BEFORE_ATTRIBUTE_NAME;\n\t} else if(this._decodeEntities && c === \"&\"){\n\t\tthis._emitToken(\"onattribdata\");\n\t\tthis._baseState = this._state;\n\t\tthis._state = BEFORE_ENTITY;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateInAttributeValueNoQuotes = function(c){\n\tif(whitespace(c) || c === \">\"){\n\t\tthis._emitToken(\"onattribdata\");\n\t\tthis._cbs.onattribend();\n\t\tthis._state = BEFORE_ATTRIBUTE_NAME;\n\t\tthis._index--;\n\t} else if(this._decodeEntities && c === \"&\"){\n\t\tthis._emitToken(\"onattribdata\");\n\t\tthis._baseState = this._state;\n\t\tthis._state = BEFORE_ENTITY;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateBeforeDeclaration = function(c){\n\tthis._state = c === \"[\" ? BEFORE_CDATA_1 :\n\t\t\t\t\tc === \"-\" ? BEFORE_COMMENT :\n\t\t\t\t\t\tIN_DECLARATION;\n};\n\nTokenizer.prototype._stateInDeclaration = function(c){\n\tif(c === \">\"){\n\t\tthis._cbs.ondeclaration(this._getSection());\n\t\tthis._state = TEXT;\n\t\tthis._sectionStart = this._index + 1;\n\t}\n};\n\nTokenizer.prototype._stateInProcessingInstruction = function(c){\n\tif(c === \">\"){\n\t\tthis._cbs.onprocessinginstruction(this._getSection());\n\t\tthis._state = TEXT;\n\t\tthis._sectionStart = this._index + 1;\n\t}\n};\n\nTokenizer.prototype._stateBeforeComment = function(c){\n\tif(c === \"-\"){\n\t\tthis._state = IN_COMMENT;\n\t\tthis._sectionStart = this._index + 1;\n\t} else {\n\t\tthis._state = IN_DECLARATION;\n\t}\n};\n\nTokenizer.prototype._stateInComment = function(c){\n\tif(c === \"-\") this._state = AFTER_COMMENT_1;\n};\n\nTokenizer.prototype._stateAfterComment1 = function(c){\n\tif(c === \"-\"){\n\t\tthis._state = AFTER_COMMENT_2;\n\t} else {\n\t\tthis._state = IN_COMMENT;\n\t}\n};\n\nTokenizer.prototype._stateAfterComment2 = function(c){\n\tif(c === \">\"){\n\t\t//remove 2 trailing chars\n\t\tthis._cbs.oncomment(this._buffer.substring(this._sectionStart, this._index - 2));\n\t\tthis._state = TEXT;\n\t\tthis._sectionStart = this._index + 1;\n\t} else if(c !== \"-\"){\n\t\tthis._state = IN_COMMENT;\n\t}\n\t// else: stay in AFTER_COMMENT_2 (`--->`)\n};\n\nTokenizer.prototype._stateBeforeCdata1 = ifElseState(\"C\", BEFORE_CDATA_2, IN_DECLARATION);\nTokenizer.prototype._stateBeforeCdata2 = ifElseState(\"D\", BEFORE_CDATA_3, IN_DECLARATION);\nTokenizer.prototype._stateBeforeCdata3 = ifElseState(\"A\", BEFORE_CDATA_4, IN_DECLARATION);\nTokenizer.prototype._stateBeforeCdata4 = ifElseState(\"T\", BEFORE_CDATA_5, IN_DECLARATION);\nTokenizer.prototype._stateBeforeCdata5 = ifElseState(\"A\", BEFORE_CDATA_6, IN_DECLARATION);\n\nTokenizer.prototype._stateBeforeCdata6 = function(c){\n\tif(c === \"[\"){\n\t\tthis._state = IN_CDATA;\n\t\tthis._sectionStart = this._index + 1;\n\t} else {\n\t\tthis._state = IN_DECLARATION;\n\t\tthis._index--;\n\t}\n};\n\nTokenizer.prototype._stateInCdata = function(c){\n\tif(c === \"]\") this._state = AFTER_CDATA_1;\n};\n\nTokenizer.prototype._stateAfterCdata1 = characterState(\"]\", AFTER_CDATA_2);\n\nTokenizer.prototype._stateAfterCdata2 = function(c){\n\tif(c === \">\"){\n\t\t//remove 2 trailing chars\n\t\tthis._cbs.oncdata(this._buffer.substring(this._sectionStart, this._index - 2));\n\t\tthis._state = TEXT;\n\t\tthis._sectionStart = this._index + 1;\n\t} else if(c !== \"]\") {\n\t\tthis._state = IN_CDATA;\n\t}\n\t//else: stay in AFTER_CDATA_2 (`]]]>`)\n};\n\nTokenizer.prototype._stateBeforeSpecial = function(c){\n\tif(c === \"c\" || c === \"C\"){\n\t\tthis._state = BEFORE_SCRIPT_1;\n\t} else if(c === \"t\" || c === \"T\"){\n\t\tthis._state = BEFORE_STYLE_1;\n\t} else {\n\t\tthis._state = IN_TAG_NAME;\n\t\tthis._index--; //consume the token again\n\t}\n};\n\nTokenizer.prototype._stateBeforeSpecialEnd = function(c){\n\tif(this._special === SPECIAL_SCRIPT && (c === \"c\" || c === \"C\")){\n\t\tthis._state = AFTER_SCRIPT_1;\n\t} else if(this._special === SPECIAL_STYLE && (c === \"t\" || c === \"T\")){\n\t\tthis._state = AFTER_STYLE_1;\n\t}\n\telse this._state = TEXT;\n};\n\nTokenizer.prototype._stateBeforeScript1 = consumeSpecialNameChar(\"R\", BEFORE_SCRIPT_2);\nTokenizer.prototype._stateBeforeScript2 = consumeSpecialNameChar(\"I\", BEFORE_SCRIPT_3);\nTokenizer.prototype._stateBeforeScript3 = consumeSpecialNameChar(\"P\", BEFORE_SCRIPT_4);\nTokenizer.prototype._stateBeforeScript4 = consumeSpecialNameChar(\"T\", BEFORE_SCRIPT_5);\n\nTokenizer.prototype._stateBeforeScript5 = function(c){\n\tif(c === \"/\" || c === \">\" || whitespace(c)){\n\t\tthis._special = SPECIAL_SCRIPT;\n\t}\n\tthis._state = IN_TAG_NAME;\n\tthis._index--; //consume the token again\n};\n\nTokenizer.prototype._stateAfterScript1 = ifElseState(\"R\", AFTER_SCRIPT_2, TEXT);\nTokenizer.prototype._stateAfterScript2 = ifElseState(\"I\", AFTER_SCRIPT_3, TEXT);\nTokenizer.prototype._stateAfterScript3 = ifElseState(\"P\", AFTER_SCRIPT_4, TEXT);\nTokenizer.prototype._stateAfterScript4 = ifElseState(\"T\", AFTER_SCRIPT_5, TEXT);\n\nTokenizer.prototype._stateAfterScript5 = function(c){\n\tif(c === \">\" || whitespace(c)){\n\t\tthis._special = SPECIAL_NONE;\n\t\tthis._state = IN_CLOSING_TAG_NAME;\n\t\tthis._sectionStart = this._index - 6;\n\t\tthis._index--; //reconsume the token\n\t}\n\telse this._state = TEXT;\n};\n\nTokenizer.prototype._stateBeforeStyle1 = consumeSpecialNameChar(\"Y\", BEFORE_STYLE_2);\nTokenizer.prototype._stateBeforeStyle2 = consumeSpecialNameChar(\"L\", BEFORE_STYLE_3);\nTokenizer.prototype._stateBeforeStyle3 = consumeSpecialNameChar(\"E\", BEFORE_STYLE_4);\n\nTokenizer.prototype._stateBeforeStyle4 = function(c){\n\tif(c === \"/\" || c === \">\" || whitespace(c)){\n\t\tthis._special = SPECIAL_STYLE;\n\t}\n\tthis._state = IN_TAG_NAME;\n\tthis._index--; //consume the token again\n};\n\nTokenizer.prototype._stateAfterStyle1 = ifElseState(\"Y\", AFTER_STYLE_2, TEXT);\nTokenizer.prototype._stateAfterStyle2 = ifElseState(\"L\", AFTER_STYLE_3, TEXT);\nTokenizer.prototype._stateAfterStyle3 = ifElseState(\"E\", AFTER_STYLE_4, TEXT);\n\nTokenizer.prototype._stateAfterStyle4 = function(c){\n\tif(c === \">\" || whitespace(c)){\n\t\tthis._special = SPECIAL_NONE;\n\t\tthis._state = IN_CLOSING_TAG_NAME;\n\t\tthis._sectionStart = this._index - 5;\n\t\tthis._index--; //reconsume the token\n\t}\n\telse this._state = TEXT;\n};\n\nTokenizer.prototype._stateBeforeEntity = ifElseState(\"#\", BEFORE_NUMERIC_ENTITY, IN_NAMED_ENTITY);\nTokenizer.prototype._stateBeforeNumericEntity = ifElseState(\"X\", IN_HEX_ENTITY, IN_NUMERIC_ENTITY);\n\n//for entities terminated with a semicolon\nTokenizer.prototype._parseNamedEntityStrict = function(){\n\t//offset = 1\n\tif(this._sectionStart + 1 < this._index){\n\t\tvar entity = this._buffer.substring(this._sectionStart + 1, this._index),\n\t\t    map = this._xmlMode ? xmlMap : entityMap;\n\n\t\tif(map.hasOwnProperty(entity)){\n\t\t\tthis._emitPartial(map[entity]);\n\t\t\tthis._sectionStart = this._index + 1;\n\t\t}\n\t}\n};\n\n\n//parses legacy entities (without trailing semicolon)\nTokenizer.prototype._parseLegacyEntity = function(){\n\tvar start = this._sectionStart + 1,\n\t    limit = this._index - start;\n\n\tif(limit > 6) limit = 6; //the max length of legacy entities is 6\n\n\twhile(limit >= 2){ //the min length of legacy entities is 2\n\t\tvar entity = this._buffer.substr(start, limit);\n\n\t\tif(legacyMap.hasOwnProperty(entity)){\n\t\t\tthis._emitPartial(legacyMap[entity]);\n\t\t\tthis._sectionStart += limit + 1;\n\t\t\treturn;\n\t\t} else {\n\t\t\tlimit--;\n\t\t}\n\t}\n};\n\nTokenizer.prototype._stateInNamedEntity = function(c){\n\tif(c === \";\"){\n\t\tthis._parseNamedEntityStrict();\n\t\tif(this._sectionStart + 1 < this._index && !this._xmlMode){\n\t\t\tthis._parseLegacyEntity();\n\t\t}\n\t\tthis._state = this._baseState;\n\t} else if((c < \"a\" || c > \"z\") && (c < \"A\" || c > \"Z\") && (c < \"0\" || c > \"9\")){\n\t\tif(this._xmlMode);\n\t\telse if(this._sectionStart + 1 === this._index);\n\t\telse if(this._baseState !== TEXT){\n\t\t\tif(c !== \"=\"){\n\t\t\t\tthis._parseNamedEntityStrict();\n\t\t\t}\n\t\t} else {\n\t\t\tthis._parseLegacyEntity();\n\t\t}\n\n\t\tthis._state = this._baseState;\n\t\tthis._index--;\n\t}\n};\n\nTokenizer.prototype._decodeNumericEntity = function(offset, base){\n\tvar sectionStart = this._sectionStart + offset;\n\n\tif(sectionStart !== this._index){\n\t\t//parse entity\n\t\tvar entity = this._buffer.substring(sectionStart, this._index);\n\t\tvar parsed = parseInt(entity, base);\n\n\t\tthis._emitPartial(decodeCodePoint(parsed));\n\t\tthis._sectionStart = this._index;\n\t} else {\n\t\tthis._sectionStart--;\n\t}\n\n\tthis._state = this._baseState;\n};\n\nTokenizer.prototype._stateInNumericEntity = function(c){\n\tif(c === \";\"){\n\t\tthis._decodeNumericEntity(2, 10);\n\t\tthis._sectionStart++;\n\t} else if(c < \"0\" || c > \"9\"){\n\t\tif(!this._xmlMode){\n\t\t\tthis._decodeNumericEntity(2, 10);\n\t\t} else {\n\t\t\tthis._state = this._baseState;\n\t\t}\n\t\tthis._index--;\n\t}\n};\n\nTokenizer.prototype._stateInHexEntity = function(c){\n\tif(c === \";\"){\n\t\tthis._decodeNumericEntity(3, 16);\n\t\tthis._sectionStart++;\n\t} else if((c < \"a\" || c > \"f\") && (c < \"A\" || c > \"F\") && (c < \"0\" || c > \"9\")){\n\t\tif(!this._xmlMode){\n\t\t\tthis._decodeNumericEntity(3, 16);\n\t\t} else {\n\t\t\tthis._state = this._baseState;\n\t\t}\n\t\tthis._index--;\n\t}\n};\n\nTokenizer.prototype._cleanup = function (){\n\tif(this._sectionStart < 0){\n\t\tthis._buffer = \"\";\n\t\tthis._index = 0;\n\t\tthis._bufferOffset += this._index;\n\t} else if(this._running){\n\t\tif(this._state === TEXT){\n\t\t\tif(this._sectionStart !== this._index){\n\t\t\t\tthis._cbs.ontext(this._buffer.substr(this._sectionStart));\n\t\t\t}\n\t\t\tthis._buffer = \"\";\n\t\t\tthis._index = 0;\n\t\t\tthis._bufferOffset += this._index;\n\t\t} else if(this._sectionStart === this._index){\n\t\t\t//the section just started\n\t\t\tthis._buffer = \"\";\n\t\t\tthis._index = 0;\n\t\t\tthis._bufferOffset += this._index;\n\t\t} else {\n\t\t\t//remove everything unnecessary\n\t\t\tthis._buffer = this._buffer.substr(this._sectionStart);\n\t\t\tthis._index -= this._sectionStart;\n\t\t\tthis._bufferOffset += this._sectionStart;\n\t\t}\n\n\t\tthis._sectionStart = 0;\n\t}\n};\n\n//TODO make events conditional\nTokenizer.prototype.write = function(chunk){\n\tif(this._ended) this._cbs.onerror(Error(\".write() after done!\"));\n\n\tthis._buffer += chunk;\n\tthis._parse();\n};\n\nTokenizer.prototype._parse = function(){\n\twhile(this._index < this._buffer.length && this._running){\n\t\tvar c = this._buffer.charAt(this._index);\n\t\tif(this._state === TEXT) {\n\t\t\tthis._stateText(c);\n\t\t} else if(this._state === BEFORE_TAG_NAME){\n\t\t\tthis._stateBeforeTagName(c);\n\t\t} else if(this._state === IN_TAG_NAME) {\n\t\t\tthis._stateInTagName(c);\n\t\t} else if(this._state === BEFORE_CLOSING_TAG_NAME){\n\t\t\tthis._stateBeforeCloseingTagName(c);\n\t\t} else if(this._state === IN_CLOSING_TAG_NAME){\n\t\t\tthis._stateInCloseingTagName(c);\n\t\t} else if(this._state === AFTER_CLOSING_TAG_NAME){\n\t\t\tthis._stateAfterCloseingTagName(c);\n\t\t} else if(this._state === IN_SELF_CLOSING_TAG){\n\t\t\tthis._stateInSelfClosingTag(c);\n\t\t}\n\n\t\t/*\n\t\t*\tattributes\n\t\t*/\n\t\telse if(this._state === BEFORE_ATTRIBUTE_NAME){\n\t\t\tthis._stateBeforeAttributeName(c);\n\t\t} else if(this._state === IN_ATTRIBUTE_NAME){\n\t\t\tthis._stateInAttributeName(c);\n\t\t} else if(this._state === AFTER_ATTRIBUTE_NAME){\n\t\t\tthis._stateAfterAttributeName(c);\n\t\t} else if(this._state === BEFORE_ATTRIBUTE_VALUE){\n\t\t\tthis._stateBeforeAttributeValue(c);\n\t\t} else if(this._state === IN_ATTRIBUTE_VALUE_DQ){\n\t\t\tthis._stateInAttributeValueDoubleQuotes(c);\n\t\t} else if(this._state === IN_ATTRIBUTE_VALUE_SQ){\n\t\t\tthis._stateInAttributeValueSingleQuotes(c);\n\t\t} else if(this._state === IN_ATTRIBUTE_VALUE_NQ){\n\t\t\tthis._stateInAttributeValueNoQuotes(c);\n\t\t}\n\n\t\t/*\n\t\t*\tdeclarations\n\t\t*/\n\t\telse if(this._state === BEFORE_DECLARATION){\n\t\t\tthis._stateBeforeDeclaration(c);\n\t\t} else if(this._state === IN_DECLARATION){\n\t\t\tthis._stateInDeclaration(c);\n\t\t}\n\n\t\t/*\n\t\t*\tprocessing instructions\n\t\t*/\n\t\telse if(this._state === IN_PROCESSING_INSTRUCTION){\n\t\t\tthis._stateInProcessingInstruction(c);\n\t\t}\n\n\t\t/*\n\t\t*\tcomments\n\t\t*/\n\t\telse if(this._state === BEFORE_COMMENT){\n\t\t\tthis._stateBeforeComment(c);\n\t\t} else if(this._state === IN_COMMENT){\n\t\t\tthis._stateInComment(c);\n\t\t} else if(this._state === AFTER_COMMENT_1){\n\t\t\tthis._stateAfterComment1(c);\n\t\t} else if(this._state === AFTER_COMMENT_2){\n\t\t\tthis._stateAfterComment2(c);\n\t\t}\n\n\t\t/*\n\t\t*\tcdata\n\t\t*/\n\t\telse if(this._state === BEFORE_CDATA_1){\n\t\t\tthis._stateBeforeCdata1(c);\n\t\t} else if(this._state === BEFORE_CDATA_2){\n\t\t\tthis._stateBeforeCdata2(c);\n\t\t} else if(this._state === BEFORE_CDATA_3){\n\t\t\tthis._stateBeforeCdata3(c);\n\t\t} else if(this._state === BEFORE_CDATA_4){\n\t\t\tthis._stateBeforeCdata4(c);\n\t\t} else if(this._state === BEFORE_CDATA_5){\n\t\t\tthis._stateBeforeCdata5(c);\n\t\t} else if(this._state === BEFORE_CDATA_6){\n\t\t\tthis._stateBeforeCdata6(c);\n\t\t} else if(this._state === IN_CDATA){\n\t\t\tthis._stateInCdata(c);\n\t\t} else if(this._state === AFTER_CDATA_1){\n\t\t\tthis._stateAfterCdata1(c);\n\t\t} else if(this._state === AFTER_CDATA_2){\n\t\t\tthis._stateAfterCdata2(c);\n\t\t}\n\n\t\t/*\n\t\t* special tags\n\t\t*/\n\t\telse if(this._state === BEFORE_SPECIAL){\n\t\t\tthis._stateBeforeSpecial(c);\n\t\t} else if(this._state === BEFORE_SPECIAL_END){\n\t\t\tthis._stateBeforeSpecialEnd(c);\n\t\t}\n\n\t\t/*\n\t\t* script\n\t\t*/\n\t\telse if(this._state === BEFORE_SCRIPT_1){\n\t\t\tthis._stateBeforeScript1(c);\n\t\t} else if(this._state === BEFORE_SCRIPT_2){\n\t\t\tthis._stateBeforeScript2(c);\n\t\t} else if(this._state === BEFORE_SCRIPT_3){\n\t\t\tthis._stateBeforeScript3(c);\n\t\t} else if(this._state === BEFORE_SCRIPT_4){\n\t\t\tthis._stateBeforeScript4(c);\n\t\t} else if(this._state === BEFORE_SCRIPT_5){\n\t\t\tthis._stateBeforeScript5(c);\n\t\t}\n\n\t\telse if(this._state === AFTER_SCRIPT_1){\n\t\t\tthis._stateAfterScript1(c);\n\t\t} else if(this._state === AFTER_SCRIPT_2){\n\t\t\tthis._stateAfterScript2(c);\n\t\t} else if(this._state === AFTER_SCRIPT_3){\n\t\t\tthis._stateAfterScript3(c);\n\t\t} else if(this._state === AFTER_SCRIPT_4){\n\t\t\tthis._stateAfterScript4(c);\n\t\t} else if(this._state === AFTER_SCRIPT_5){\n\t\t\tthis._stateAfterScript5(c);\n\t\t}\n\n\t\t/*\n\t\t* style\n\t\t*/\n\t\telse if(this._state === BEFORE_STYLE_1){\n\t\t\tthis._stateBeforeStyle1(c);\n\t\t} else if(this._state === BEFORE_STYLE_2){\n\t\t\tthis._stateBeforeStyle2(c);\n\t\t} else if(this._state === BEFORE_STYLE_3){\n\t\t\tthis._stateBeforeStyle3(c);\n\t\t} else if(this._state === BEFORE_STYLE_4){\n\t\t\tthis._stateBeforeStyle4(c);\n\t\t}\n\n\t\telse if(this._state === AFTER_STYLE_1){\n\t\t\tthis._stateAfterStyle1(c);\n\t\t} else if(this._state === AFTER_STYLE_2){\n\t\t\tthis._stateAfterStyle2(c);\n\t\t} else if(this._state === AFTER_STYLE_3){\n\t\t\tthis._stateAfterStyle3(c);\n\t\t} else if(this._state === AFTER_STYLE_4){\n\t\t\tthis._stateAfterStyle4(c);\n\t\t}\n\n\t\t/*\n\t\t* entities\n\t\t*/\n\t\telse if(this._state === BEFORE_ENTITY){\n\t\t\tthis._stateBeforeEntity(c);\n\t\t} else if(this._state === BEFORE_NUMERIC_ENTITY){\n\t\t\tthis._stateBeforeNumericEntity(c);\n\t\t} else if(this._state === IN_NAMED_ENTITY){\n\t\t\tthis._stateInNamedEntity(c);\n\t\t} else if(this._state === IN_NUMERIC_ENTITY){\n\t\t\tthis._stateInNumericEntity(c);\n\t\t} else if(this._state === IN_HEX_ENTITY){\n\t\t\tthis._stateInHexEntity(c);\n\t\t}\n\n\t\telse {\n\t\t\tthis._cbs.onerror(Error(\"unknown _state\"), this._state);\n\t\t}\n\n\t\tthis._index++;\n\t}\n\n\tthis._cleanup();\n};\n\nTokenizer.prototype.pause = function(){\n\tthis._running = false;\n};\nTokenizer.prototype.resume = function(){\n\tthis._running = true;\n\n\tif(this._index < this._buffer.length){\n\t\tthis._parse();\n\t}\n\tif(this._ended){\n\t\tthis._finish();\n\t}\n};\n\nTokenizer.prototype.end = function(chunk){\n\tif(this._ended) this._cbs.onerror(Error(\".end() after done!\"));\n\tif(chunk) this.write(chunk);\n\n\tthis._ended = true;\n\n\tif(this._running) this._finish();\n};\n\nTokenizer.prototype._finish = function(){\n\t//if there is remaining data, emit it in a reasonable way\n\tif(this._sectionStart < this._index){\n\t\tthis._handleTrailingData();\n\t}\n\n\tthis._cbs.onend();\n};\n\nTokenizer.prototype._handleTrailingData = function(){\n\tvar data = this._buffer.substr(this._sectionStart);\n\n\tif(this._state === IN_CDATA || this._state === AFTER_CDATA_1 || this._state === AFTER_CDATA_2){\n\t\tthis._cbs.oncdata(data);\n\t} else if(this._state === IN_COMMENT || this._state === AFTER_COMMENT_1 || this._state === AFTER_COMMENT_2){\n\t\tthis._cbs.oncomment(data);\n\t} else if(this._state === IN_NAMED_ENTITY && !this._xmlMode){\n\t\tthis._parseLegacyEntity();\n\t\tif(this._sectionStart < this._index){\n\t\t\tthis._state = this._baseState;\n\t\t\tthis._handleTrailingData();\n\t\t}\n\t} else if(this._state === IN_NUMERIC_ENTITY && !this._xmlMode){\n\t\tthis._decodeNumericEntity(2, 10);\n\t\tif(this._sectionStart < this._index){\n\t\t\tthis._state = this._baseState;\n\t\t\tthis._handleTrailingData();\n\t\t}\n\t} else if(this._state === IN_HEX_ENTITY && !this._xmlMode){\n\t\tthis._decodeNumericEntity(3, 16);\n\t\tif(this._sectionStart < this._index){\n\t\t\tthis._state = this._baseState;\n\t\t\tthis._handleTrailingData();\n\t\t}\n\t} else if(\n\t\tthis._state !== IN_TAG_NAME &&\n\t\tthis._state !== BEFORE_ATTRIBUTE_NAME &&\n\t\tthis._state !== BEFORE_ATTRIBUTE_VALUE &&\n\t\tthis._state !== AFTER_ATTRIBUTE_NAME &&\n\t\tthis._state !== IN_ATTRIBUTE_NAME &&\n\t\tthis._state !== IN_ATTRIBUTE_VALUE_SQ &&\n\t\tthis._state !== IN_ATTRIBUTE_VALUE_DQ &&\n\t\tthis._state !== IN_ATTRIBUTE_VALUE_NQ &&\n\t\tthis._state !== IN_CLOSING_TAG_NAME\n\t){\n\t\tthis._cbs.ontext(data);\n\t}\n\t//else, ignore remaining data\n\t//TODO add a way to remove current tag\n};\n\nTokenizer.prototype.reset = function(){\n\tTokenizer.call(this, {xmlMode: this._xmlMode, decodeEntities: this._decodeEntities}, this._cbs);\n};\n\nTokenizer.prototype.getAbsoluteIndex = function(){\n\treturn this._bufferOffset + this._index;\n};\n\nTokenizer.prototype._getSection = function(){\n\treturn this._buffer.substring(this._sectionStart, this._index);\n};\n\nTokenizer.prototype._emitToken = function(name){\n\tthis._cbs[name](this._getSection());\n\tthis._sectionStart = -1;\n};\n\nTokenizer.prototype._emitPartial = function(value){\n\tif(this._baseState !== TEXT){\n\t\tthis._cbs.onattribdata(value); //TODO implement the new event\n\t} else {\n\t\tthis._cbs.ontext(value);\n\t}\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}